#!/usr/bin/env jruby

$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__) + "/../lib"))
require 'roodi'

def roodi(ruby_files)
  roodi = Roodi::Core::Runner.new(Roodi::Checks::ClassNameCheck.new, 
                                  Roodi::Checks::CyclomaticComplexityBlockCheck.new,
                                  Roodi::Checks::CyclomaticComplexityMethodCheck.new,
                                  Roodi::Checks::EmptyRescueBodyCheck.new,
                                  Roodi::Checks::ForLoopCheck.new,
                                  # Roodi::Checks::MagicNumberCheck.new,
                                  Roodi::Checks::MethodNameCheck.new, 
                                  Roodi::Checks::MethodLineCountCheck.new)
  ruby_files.each { |file| roodi.check_file(file) }
  roodi.errors.each {|error| puts error}
  puts "\nFound #{roodi.errors.size} errors."
end

pattern = File.join(ARGV[0], "**", "*.rb")
roodi(Dir.glob(pattern))
