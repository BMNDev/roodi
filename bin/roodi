#!/usr/bin/env ruby

$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__) + "/../lib"))

require 'roodi'

runner = Roodi::Core::Runner.new

config_param = ARGV.detect {|arg| arg =~ /-config=.*/}
runner.config = config_param.split("=")[1] if config_param
ARGV.delete config_param

puts "\nRunning Roodi checks"

runner.start(ARGV)
runner.errors.each {|error| puts error}

puts "\nChecked #{runner.files_checked} files"
puts "Found #{runner.errors.size} errors"

exit runner.errors.size
